{"ts":1357945180200,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Get results from locator\r\nfunction locateQuery(text, wkid, maxLocations, callback) {\r\n    // Max results\r\n    if (!maxLocations) {\r\n        maxLocations = 1;\r\n    }\r\n    if (!wkid) {\r\n        wkid = 102100;\r\n    }\r\n    // Query object\r\n    var queryContent = {\r\n        \"text\": text,\r\n        \"outSR\": wkid,\r\n        \"outFields\": \"*\",\r\n        \"sourceCountry\": configOptions.sourceCountry,\r\n        \"maxLocations\": maxLocations,\r\n        \"f\": \"json\"\r\n    };\r\n    // send request\r\n    var requestHandle = esri.request({\r\n        url: configOptions.locatorserviceurl + '/find',\r\n        content: queryContent,\r\n        callbackParamName: \"callback\",\r\n        // on load\r\n        load: function (response) {\r\n            if (typeof callback === 'function') {\r\n                // call callback function\r\n                callback.call(this, response);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n// clear the locate graphic\r\nfunction resetLocateLayer() {\r\n    if (configOptions.locateLayer) {\r\n        configOptions.locateLayer.clear();\r\n    }\r\n    configOptions.locateName = \"\";\r\n    setSharing();\r\n}\r\n\r\n// hide auto complete results timeout\r\nfunction resetHideACTimeout() {\r\n    clearTimeout(configOptions.autocompleteTimer);\r\n    configOptions.autocompleteTimer = setTimeout(hideAC, 6000);\r\n}\r\n\r\n// Locate address\r\nfunction locate() {\r\n    var query = dojo.query('#address').attr('value')[0];\r\n    if (query) {\r\n        locateQuery(query, map.extent.spatialReference.wkid, 1, showResults);\r\n        setSharing();\r\n    } else {\r\n        alertDialog(i18n.viewer.errors.noText);\r\n    }\r\n}\r\n\r\n// Show autocomplete\r\nfunction showAutoComplete(results) {\r\n    configOptions.autocompleteResults = results;\r\n    resetHideACTimeout();\r\n    var aResults = '';\r\n    var addressPosition = dojo.query('#locateBox')[0];\r\n    var offset = dojo.position(addressPosition);\r\n    var partialMatch = dojo.query('#address').attr('value');\r\n    var regex = new RegExp('(' + partialMatch + ')', 'gi');\r\n    var autoCompleteObj = dojo.query('#autoComplete');\r\n    var box = dojo.marginBox(addressPosition);\r\n    autoCompleteObj.style({\r\n        'left': offset.x + 'px',\r\n        'top': box.h + 'px'\r\n    });\r\n    aResults += '<div class=\"menuClose\"><div class=\"closeButton closeAC\"></div>' + i18n.viewer.autoComplete.menuTitle + '<div class=\"clear\"></div></div>';\r\n    aResults += '<ul class=\"zebraStripes\">';\r\n    var i;\r\n    for (i = 0; i < results.locations.length; ++i) {\r\n        var layerClass = '';\r\n        if (i % 2 === 0) {\r\n            layerClass = '';\r\n        } else {\r\n            layerClass = 'stripe';\r\n        }\r\n        aResults += '<li data-index=\"' + i + '\" tabindex=\"0\" class=\"' + layerClass + '\">' + results.locations[i].name.replace(regex, '<span>' + partialMatch + '</span>') + '</li>';\r\n    }\r\n    aResults += '</ul>';\r\n    if (results.locations.length > 0) {\r\n        if (autoCompleteObj[0]) {\r\n            autoCompleteObj[0].innerHTML = aResults;\r\n        }\r\n        autoCompleteObj.style('display', 'block');\r\n    } else {\r\n        hideAC();\r\n    }\r\n\r\n}\r\n\r\nfunction setMarker(point, address) {\r\n    if (configOptions.pointGraphic) {\r\n        // Create point marker\r\n        var pointGraphic = new esri.symbol.PictureMarkerSymbol(configOptions.pointGraphic, 21, 29).setOffset(0, 12);\r\n        var locationGraphic = new esri.Graphic(point, pointGraphic);\r\n        // if locate point layer\r\n        if (configOptions.locateLayer) {\r\n            configOptions.locateLayer.clear();\r\n            clearPopupValues();\r\n            configOptions.customPopup.hide();\r\n        } else {\r\n            configOptions.locateLayer = new esri.layers.GraphicsLayer();\r\n            dojo.connect(configOptions.locateLayer, \"onClick\",\r\n\r\n            function (evt) {\r\n                clearPopupValues();\r\n                dojo.stopEvent(evt);\r\n                var content = \"<strong>\" + evt.graphic.attributes.address + \"</strong>\";\r\n                configOptions.customPopup.setContent(content);\r\n                configOptions.customPopup.setTitle(i18n.viewer.search.location);\r\n                configOptions.customPopup.show(evt.graphic.geometry);\r\n            });\r\n            map.addLayer(configOptions.locateLayer);\r\n        }\r\n        // graphic\r\n        locationGraphic.setAttributes({\r\n            \"address\": address\r\n        });\r\n        configOptions.locateLayer.add(locationGraphic);\r\n    }\r\n}\r\n\r\n// Show locate results\r\nfunction showResults(results, resultNumber) {\r\n    // if results\r\n    if (results.locations.length > 0) {\r\n        // result number\r\n        var numResult = 0;\r\n        if (resultNumber) {\r\n            numResult = resultNumber;\r\n        }\r\n\t\tvar sr = new esri.SpatialReference(results.spatialReference);\r\n        // new extent\r\n        var extent = new esri.geometry.Extent(results.locations[numResult].extent);\r\n\t\textent.setSpatialReference(sr);\r\n        // center of extent\r\n        var point = new esri.geometry.Point(results.locations[numResult].feature.geometry);\r\n\t\tpoint.setSpatialReference(sr);\r\n        // set marker\r\n        configOptions.locatePoint[0] = point.x;\r\n        configOptions.locatePoint[1] = point.y;\r\n        dojo.query('#address').attr('value', results.locations[numResult].name);\r\n        configOptions.locateName = results.locations[numResult].name;\r\n        // Set extent\r\n        map.setExtent(extent);\r\n\t\t// set point marker\r\n        setMarker(point, results.locations[numResult].name);\r\n    } else {\r\n        alertDialog(i18n.viewer.errors.noLocation);\r\n        resetLocateLayer();\r\n        clearAddress(dojo.query('#address'));\r\n    }\r\n    hideAC();\r\n}\r\n\r\n// hide autocopmlete\r\nfunction hideAC() {\r\n    dojo.query('#autoComplete').style('display', 'none');\r\n}\r\n\r\n// clear locate box\r\nfunction clearAddress(obj) {\r\n    dojo.query(obj).attr('value', '');\r\n    var iconReset = dojo.query(obj).prev('.iconClear');\r\n    iconReset.removeClass('iconReset').attr('title', '');\r\n}\r\n\r\n// see if locate box is populated\r\nfunction checkAddressStatus(obj) {\r\n    var cAVal = dojo.query(obj).attr('value')[0];\r\n    var iconReset = dojo.query(obj).prev('.iconClear');\r\n    if (cAVal !== '') {\r\n        iconReset.addClass('iconReset').attr(\"title\", i18n.viewer.search.clearLocation);\r\n    } else {\r\n        clearAddress(obj);\r\n    }\r\n}\r\n\r\n// resize map\r\nfunction resizeMap() {\r\n    //clear any existing resize timer\r\n    clearTimeout(configOptions.mapTimer);\r\n    //create new resize timer with delay of 500 milliseconds\r\n    configOptions.mapTimer = setTimeout(function () {\r\n        if (map) {\r\n            var barHeight = 0,\r\n                chartHeight = 0;\r\n            // menu bar height\r\n            var menuBar = dojo.byId('topMenuBar');\r\n            if (menuBar) {\r\n                var menuPos = dojo.position(menuBar);\r\n                barHeight = menuPos.h;\r\n            }\r\n            // chart height\r\n            var chartNode = dojo.byId('graphBar');\r\n            if (chartNode) {\r\n                var chartPos = dojo.position(chartNode);\r\n                chartHeight = chartPos.h;\r\n            }\r\n            // window height\r\n            var vs = dojo.window.getBox();\r\n            var windowHeight = vs.h;\r\n            var node = dojo.byId('map');\r\n            if (node) {\r\n                dojo.style(node, {\r\n                    \"height\": windowHeight - barHeight - chartHeight + 'px'\r\n                });\r\n            }\r\n            // resize\r\n            map.resize();\r\n            map.reposition();\r\n            // update location of menus\r\n            updateLeftMenuOffset('#shareMap', '#shareControls');\r\n            updateLeftMenuOffset('#placesButton', '#placesMenu');\r\n            updateRightMenuOffset('#layersButton', '#layersMenu');\r\n            updateRightMenuOffset('#basemapButton', '#basemapMenu');\r\n            updateRightMenuOffset('#legendButton', '#legendMenu');\r\n            updateRightMenuOffset('socialButton', '#socialMenu');\r\n        }\r\n    }, 500);\r\n}\r\n\r\nfunction hideAboutMap(){\r\n    if (configOptions.aboutDialog) {\r\n        configOptions.aboutDialog.hide();\r\n        dojo.query('#aboutMap').removeClass('barSelected');\r\n    }\r\n}\r\n\r\n// Toggle show/hide about map info\r\nfunction toggleAboutMap(obj) {\r\n    if (configOptions.aboutDialog) {\r\n        if (!configOptions.aboutDialog.get('open')) {\r\n            configOptions.aboutDialog.show();\r\n            dojo.query(obj).addClass('barSelected');\r\n        } else {\r\n            configOptions.aboutDialog.hide();\r\n            dojo.query(obj).removeClass('barSelected');\r\n        }\r\n    }\r\n}\r\n\r\n// twitter link\r\nfunction setTWLink(shLink) {\r\n    if (shLink) {\r\n        var fullLink;\r\n        var w = 650;\r\n        var h = 400;\r\n        var left = (screen.width / 2) - (w / 2);\r\n        var top = (screen.height / 2) - (h / 2);\r\n        fullLink = 'https://twitter.com/intent/tweet?' + 'url=' + encodeURIComponent(shLink) + '&text=' + encodeURIComponent(configOptions.itemInfo.item.snippet) + '&hashtags=' + 'EsriSMT';\r\n        window.open(fullLink, 'share', 'width=' + w + ',height=' + h + ',top=' + top + ',left=' + left, true);\r\n    }\r\n}\r\n\r\n// facebook link\r\nfunction setFBLink(fbLink) {\r\n    if (fbLink) {\r\n        var fullLink;\r\n        var w = 650;\r\n        var h = 360;\r\n        var left = (screen.width / 2) - (w / 2);\r\n        var top = (screen.height / 2) - (h / 2);\r\n        fullLink = 'http://www.facebook.com/sharer.php?u=' + encodeURIComponent(fbLink) + '&t=' + encodeURIComponent(configOptions.itemInfo.item.snippet);\r\n        window.open(fullLink, 'share', 'width=' + w + ',height=' + h + ',top=' + top + ',left=' + left, true);\r\n    }\r\n}\r\n\r\n// right side menu buttons\r\nfunction rightSideMenuButtons() {\r\n    var html = '';\r\n    var node;\r\n    if (configOptions.showLegendMenu && configOptions.layerInfos && configOptions.layerInfos.length > 0) {\r\n        html += '<span tabindex=\"0\" id=\"legendButton\" data-menu=\"legend\" class=\"barButton\" title=\"' + i18n.viewer.buttons.legendTitle + '\"><span class=\"barIcon legendIcon\"></span>' + i18n.viewer.buttons.legend + '</span>';\r\n        // Social MENU TOGGLE\r\n        dojo.query(document).delegate(\"#legendButton\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                toggleMenus('legend');\r\n            }\r\n        });\r\n    }\r\n    if (configOptions.showBasemapMenu) {\r\n        html += '<span tabindex=\"0\" id=\"basemapButton\" data-menu=\"basemap\" class=\"barButton\" title=\"' + i18n.viewer.buttons.basemapTitle + '\"><span class=\"barIcon basemapIcon\"></span>' + i18n.viewer.buttons.basemap + '</span>';\r\n        // Basemap MENU TOGGLE\r\n        dojo.query(document).delegate(\"#basemapButton\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                toggleMenus('basemap');\r\n            }\r\n        });\r\n        node = dojo.byId('basemapMenu');\r\n        if (node) {\r\n            node.innerHTML = '<div class=\"menuClose\"><div class=\"closeButton closeMenu\"></div>' + i18n.viewer.basemap.menuTitle + '<div class=\"clear\"></div></div><div class=\"bmMenuCon\"><div class=\"slideScroll\"><div id=\"baseContainer\"></div></div></div>';\r\n        }\r\n        // basemap gallery prepend to node\r\n        if (configOptions.bmDijit) {\r\n            dojo.place(configOptions.bmDijit.domNode, dojo.byId(\"baseContainer\"), \"first\");\r\n        }\r\n    }\r\n    if (configOptions.showLayersMenu) {\r\n        html += '<span tabindex=\"0\" id=\"layersButton\" data-menu=\"layers\" class=\"barButton\" title=\"' + i18n.viewer.buttons.layersTitle + '\"><span class=\"barIcon layersIcon\"></span>' + i18n.viewer.buttons.layers + '</span>';\r\n        // Layers MENU TOGGLE\r\n        dojo.query(document).delegate(\"#layersButton\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                toggleMenus('layers');\r\n            }\r\n        });\r\n    }\r\n    if (configOptions.showSocialMenu) {\r\n        html += '<span tabindex=\"0\" id=\"socialButton\" data-menu=\"social\" class=\"barButton\" title=\"' + i18n.viewer.buttons.socialTitle + '\"><span class=\"barIcon socialIcon\"></span>' + i18n.viewer.buttons.social + '</span>';\r\n        // Social MENU TOGGLE\r\n        dojo.query(document).delegate(\"#socialButton\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                toggleMenus('social');\r\n            }\r\n        });\r\n    }\r\n    node = dojo.byId('menuList');\r\n    if (node) {\r\n        node.innerHTML = html;\r\n    }\r\n    // Show Default Menu\r\n    if (configOptions.defaultMenu) {\r\n        switch (configOptions.defaultMenu) {\r\n        case 'places':\r\n            if (configOptions.showPlaces) {\r\n                toggleMenus(configOptions.defaultMenu);\r\n            }\r\n            break;\r\n        case 'basemap':\r\n            if (configOptions.showBasemapMenu) {\r\n                toggleMenus(configOptions.defaultMenu);\r\n            }\r\n            break;\r\n        case 'layers':\r\n            if (configOptions.showLayersMenu) {\r\n                toggleMenus(configOptions.defaultMenu);\r\n            }\r\n            break;\r\n        case 'social':\r\n            if (configOptions.showSocialMenu) {\r\n                toggleMenus(configOptions.defaultMenu);\r\n            }\r\n            break;\r\n        case 'legend':\r\n            if (configOptions.showLegendMenu) {\r\n                toggleMenus(configOptions.defaultMenu);\r\n            }\r\n            break;\r\n        }\r\n    }\r\n    // Show Menu Bar\r\n    //dojo.query('#topMenuBar').style('display', 'block');\r\n}\r\n\r\n// set up share menu\r\nfunction configureShareMenu() {\r\n    if (configOptions.showShareMenu) {\r\n        var node = dojo.query('#shareMap')[0];\r\n        if (node) {\r\n            node.innerHTML = '<span tabindex=\"0\" id=\"shareIcon\" data-menu=\"share\" class=\"barButton\" title=\"' + i18n.viewer.buttons.linkTitle + '\"><span class=\"barIcon iconBlock\"></span>' + i18n.viewer.buttons.link + '</span></div><div class=\"clear\">';\r\n        }\r\n        var html = '';\r\n        html += '<div class=\"menuClose\"><div class=\"closeButton closeMenu\"></div>' + i18n.viewer.shareMenu.menuTitle + '<div class=\"clear\"></div></div>';\r\n        html += '<div class=\"shareContainer\">';\r\n        html += '<div class=\"Pad\">';\r\n        html += '<h3>' + i18n.viewer.shareMenu.shareHeader + '</h3>';\r\n        html += '<input id=\"inputShare\" value=\"\" type=\"text\" class=\"mapInput inputSingle\" size=\"20\" readonly>';\r\n        html += '<span tabindex=\"0\" id=\"fbImage\" title=\"' + i18n.viewer.shareMenu.facebookHeader + '\"><span class=\"icon\"></span>' + i18n.viewer.shareMenu.facebook + '</span><span tabindex=\"0\" id=\"twImage\" title=\"' + i18n.viewer.shareMenu.twitterHeader + '\"><span class=\"icon\"></span>' + i18n.viewer.shareMenu.twitter + '</span></div>';\r\n        html += '<h3>' + i18n.viewer.shareMenu.instructionHeader + '</h3>';\r\n        html += '<textarea rows=\"3\" id=\"quickEmbedCode\"></textarea>';\r\n        if (configOptions.previewPage) {\r\n            html += '<span id=\"embedOptions\">' + i18n.viewer.shareMenu.preview + '</span>';\r\n        }\r\n        node = dojo.query('#shareControls')[0];\r\n        if (node) {\r\n            node.innerHTML = html;\r\n        }\r\n        // embed click\r\n        if (configOptions.previewPage) {\r\n            // on click\r\n            dojo.query(document).delegate(\"#embedOptions\", \"onclick,keyup\", function (event) {\r\n                if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                    var w = configOptions.previewSize.width;\r\n                    var h = configOptions.previewSize.height;\r\n                    var left = (screen.width / 2) - (w / 2);\r\n                    var top = (screen.height / 2) - (h / 2);\r\n                    window.open(configOptions.previewPage + configOptions.shareParams, 'embed', 'width=' + w + ',height=' + h + ',top=' + top + ',left=' + left, true);\r\n                }\r\n            });\r\n        }\r\n        // toggle share menu\r\n        dojo.query(document).delegate(\"#shareIcon\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                toggleMenus('share');\r\n            }\r\n        });\r\n        // share buttons\r\n        dojo.query(document).delegate(\"#fbImage\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                setFBLink(configOptions.shareURL);\r\n                return false;\r\n            }\r\n        });\r\n        dojo.query(document).delegate(\"#twImage\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                setTWLink(configOptions.shareURL);\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n// show search\r\nfunction configureSearchBox() {\r\n    if (configOptions.showSearchBox) {\r\n        var html = '<div id=\"locateCon\" class=\"iconInput\">';\r\n        html += '<div tabindex=\"0\" id=\"submitAddress\" class=\"iconSearch\" title=\"' + i18n.viewer.search.placeholder + '\"></div>';\r\n        html += '<div tabindex=\"0\" id=\"clearAddress\" class=\"iconClear\"></div>';\r\n        html += '<input placeholder=\"' + i18n.viewer.search.placeholder + '\" id=\"address\" title=\"' + i18n.viewer.search.placeholder + '\" value=\"' + configOptions.locateName + '\" class=\"default\" autocomplete=\"off\" type=\"text\" tabindex=\"1\">';\r\n        html += '</div>';\r\n        var node = dojo.query('#locateBox')[0];\r\n        if (node) {\r\n            node.innerHTML = html;\r\n        }\r\n        // close autocomplete\r\n        dojo.query(document).delegate(\".slideMenu .menuClose .closeAC\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                hideAC();\r\n            }\r\n        });\r\n        // search box javascript\r\n        dojo.query(document).delegate(\"#address\", \"onclick\", function (event) {\r\n            if (event.type === 'click') {\r\n                var cAVal2 = dojo.query(this).attr('value');\r\n                if (cAVal2 === '') {\r\n                    clearAddress(this);\r\n                }\r\n                hideAC();\r\n            }\r\n        });\r\n        dojo.query(document).delegate(\"#submitAddress\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                clearTimeout(configOptions.mapTimer);\r\n                resetLocateLayer();\r\n                locate();\r\n                hideAC();\r\n            }\r\n        });\r\n        // auto complete && address specific action listeners\r\n        dojo.query(document).delegate('#address', \"keyup\", function (event) {\r\n            var aquery = dojo.query(this).attr('value')[0];\r\n            var alength = aquery.length;\r\n            var lists;\r\n            if (event.keyCode === 13 && dojo.query(this).attr('value')[0] !== '') {\r\n                clearTimeout(configOptions.mapTimer);\r\n                resetLocateLayer();\r\n                locate();\r\n                hideAC();\r\n            } else if (event.keyCode === 38) {\r\n                resetHideACTimeout();\r\n                lists = dojo.query('#autoComplete li');\r\n                var listsLen = lists.length;\r\n                if (listsLen) {\r\n                    lists[listsLen - 1].focus();\r\n                }\r\n            } else if (event.keyCode === 40) {\r\n                resetHideACTimeout();\r\n                lists = dojo.query('#autoComplete li');\r\n                if (lists[0]) {\r\n                    lists[0].focus();\r\n                }\r\n            } else if (alength >= 2) {\r\n                clearTimeout(configOptions.autocompleteShowTimer);\r\n                configOptions.autocompleteShowTimer = setTimeout(function () {\r\n                    locateQuery(aquery, map.extent.spatialReference.wkid, 6, showAutoComplete);\r\n                }, 300);\r\n            } else {\r\n                hideAC();\r\n            }\r\n            checkAddressStatus(this);\r\n        });\r\n        dojo.query(document).delegate(\"#autoComplete ul li\", \"onclick,keyup\", function (event) {\r\n            var liSize = dojo.query('#autoComplete ul li').length;\r\n            var locTxt = dojo.query(this).text();\r\n            var locNum = parseInt(dojo.query(this).attr('data-index')[0], 10);\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                dojo.query('#address').attr('value', locTxt);\r\n                configOptions.locateName = locTxt;\r\n                setSharing();\r\n                showResults(configOptions.autocompleteResults, locNum);\r\n                hideAC();\r\n            } else if (event.type === 'keyup' && event.keyCode === 38) {\r\n                resetHideACTimeout();\r\n                newIndex = locNum - 1;\r\n                if (newIndex < 0) {\r\n                    newIndex = liSize - 1;\r\n                }\r\n                dojo.query('#autoComplete li')[newIndex].focus();\r\n            } else if (event.type === 'keyup' && event.keyCode === 40) {\r\n                resetHideACTimeout();\r\n                newIndex = locNum + 1;\r\n                if (newIndex >= liSize) {\r\n                    newIndex = 0;\r\n                }\r\n                dojo.query('#autoComplete li')[newIndex].focus();\r\n            }\r\n        });\r\n        dojo.query(document).delegate(\"#clearAddress\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                var obj = dojo.query(this).next('input');\r\n                clearAddress(obj);\r\n                resetLocateLayer();\r\n                hideAC();\r\n            }\r\n        });\r\n        // LOCATE\r\n        if (configOptions.locateName) {\r\n            checkAddressStatus('#address');\r\n        }\r\n        // Home extent\r\n        dojo.query(document).delegate(\"#homeExtent\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                map.setExtent(configOptions.startExtent);\r\n            }\r\n        });\r\n        dojo.query(document).delegate(\"#inputShare, #quickEmbedCode\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                dojo.query(this)[0].select();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n// show about button if url is set\r\nfunction configureAboutText() {\r\n    if (configOptions.itemInfo.item.description && configOptions.showAboutDialog) {\r\n        // insert html\r\n        var node = dojo.byId('aboutMapCon');\r\n        if (node) {\r\n            node.innerHTML = '<span tabindex=\"0\" class=\"barButton\" id=\"aboutMap\" title=\"' + i18n.viewer.buttons.aboutTitle + '\"><span class=\"barIcon aboutInfo\"></span>' + i18n.viewer.buttons.about + '</span>';\r\n        }\r\n        node = dojo.byId('aboutDialog');\r\n        var html = '';\r\n        html += '<div class=\"padContainer\">';\r\n        html += '<h2 tabindex=\"0\">' + configOptions.itemInfo.item.title + '</h2>';\r\n        html += '<div class=\"desc\">' + configOptions.itemInfo.item.description + '</div>';\r\n        html += '<div class=\"clear\"></div>';\r\n        // see if not just empty HTML tags\r\n        if(configOptions.itemInfo.item.licenseInfo){\r\n            var result = configOptions.itemInfo.item.licenseInfo.replace(/(<([^>]+)>)/ig, \"\");\r\n            if (configOptions.itemInfo.item.licenseInfo && result) {\r\n                html += '<h3>' + i18n.viewer.about.access + '</h3>';\r\n                html += '<div class=\"license\">' + configOptions.itemInfo.item.licenseInfo + '</div>';\r\n            }\r\n        }\r\n        html += '</div>';\r\n        if (node) {\r\n            node.innerHTML = html;\r\n        }\r\n        dojo.query(document).delegate(\"#aboutMap\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                this.blur();\r\n                hideAllMenus();\r\n                toggleAboutMap(this);\r\n            }\r\n        });\r\n        var props = {\r\n            //style: \"width:550px;\",\r\n            style: \"width:52%; max-width:725px; min-width:400px;\",\r\n            draggable: true,\r\n            modal: false,\r\n            showTitle: true,\r\n            title: i18n.viewer.about.title\r\n        };\r\n        configOptions.aboutDialog = new dijit.Dialog(props, dojo.byId('aboutDialog'));\r\n        node = dojo.query('#aboutDialog .dijitDialogTitle')[0];\r\n        if (node) {\r\n            node.innerHTML = '<span class=\"inlineIcon aboutInfo\"></span>' + i18n.viewer.about.title;\r\n        }\r\n        if (configOptions.showAboutDialogOnLoad) {\r\n            configOptions.aboutDialog.show();\r\n        }\r\n        dojo.connect(configOptions.aboutDialog, 'onHide', function(){\r\n            var buttons = dojo.query('#mapcon .barButton');\r\n            if(buttons && buttons.length > 0){\r\n                buttons.removeClass('barSelected');\r\n                for (var i = 0; i < buttons.length; i++) {\r\n                    buttons[i].blur();\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction createCustomSlider() {\r\n    var node = dojo.byId('zoomSlider');\r\n    var html = '';\r\n    if (configOptions.showGeolocation && navigator.geolocation) {\r\n        html += '<div tabindex=\"0\" title=\"' + i18n.viewer.places.myLocationTitle + '\" id=\"geoLocate\"></div>';\r\n        // geolocate click\r\n        dojo.query(document).delegate(\"#geoLocate\", \"onclick,keyup\", function (event) {\r\n            if (event.type === 'click' || (event.type === 'keyup' && event.keyCode === 13)) {\r\n                navigator.geolocation.getCurrentPosition(geoLocateMap, geoLocateMapError, {\r\n                    maximumAge: 3000,\r\n                    timeout: 5000,\r\n                    enableHighAccuracy: true\r\n                });\r\n            }\r\n        });\r\n    } else {\r\n        configOptions.showGeolocation = false;\r\n    }\r\n    var homeClass = '';\r\n    if (!configOptions.showGeolocation) {\r\n        homeClass = 'noGeo';\r\n    }\r\n    html += '<div tabindex=\"0\" title=\"' + i18n.viewer.general.homeExtent + '\" id=\"homeExtent\" class=\"' + homeClass + '\"></div>';\r\n    html += '<div id=\"customZoom\"></div>';\r\n    if (node) {\r\n        node.innerHTML = html;\r\n    }\r\n    dojo.connect(map, \"onZoomEnd\", function (evt) {\r\n\t\tvar level = map.getLevel();\r\n\t\tif(level !== -1 && configOptions.mapZoomBar){\r\n\t\t\tconfigOptions.mapZoomBar.set(\"value\", level);\r\n\t\t}\r\n    });\r\n    setTimeout(function () {\r\n        var sliderMax;\r\n        var mapLevel;\r\n        if (map.getLevel() !== -1) {\r\n            mapLevel = map.getLevel();\r\n        }\r\n        if (map._params && map._params.lods) {\r\n            sliderMax = map._params.lods.length - 1;\r\n        }\r\n\t\tif(typeof sliderMax !== 'undefined' && typeof mapLevel !== 'undefined' ){\r\n\t\t\tconfigOptions.mapZoomBar = new dijit.form.VerticalSlider({\r\n\t\t\t\tname: \"slider\",\r\n\t\t\t\tshowButtons: true,\r\n\t\t\t\tvalue: mapLevel,\r\n\t\t\t\tminimum: 0,\r\n\t\t\t\tmaximum: sliderMax,\r\n\t\t\t\tdiscreteValues: sliderMax,\r\n\t\t\t\tstyle: 'height:130px;',\r\n\t\t\t\tintermediateChanges: true,\r\n\t\t\t\tonChange: function (value) {\r\n\t\t\t\t\tvar level = parseInt(value, 10);\r\n\t\t\t\t\tif (map.getLevel() !== level) {\r\n\t\t\t\t\t\tmap.setLevel(level);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, \"customZoom\");\r\n\t\t}\r\n    }, 500);\r\n}\r\n\r\n// application title\r\nfunction configureAppTitle() {\r\n    document.title = configOptions.itemInfo.item.title;\r\n    var node = dojo.byId('mapTitle');\r\n    if (node) {\r\n        node.innerHTML = configOptions.itemInfo.item.title;\r\n        dojo.query(node).attr('title', configOptions.itemInfo.item.title);\r\n    }\r\n    dojo.query('meta[name=\"Description\"]').attr('content', configOptions.itemInfo.item.snippet);\r\n    dojo.query('meta[property=\"og:image\"]').attr('content', configOptions.sharingurl + '/' + configOptions.itemInfo.item.id + '/info/' + configOptions.itemInfo.item.thumbnail);\r\n}\r\n\r\nfunction extentReady() {\r\n    map.setExtent(configOptions.startExtent);\r\n    // set zoom level\r\n    if (configOptions.level) {\r\n        map.setLevel(parseInt(configOptions.level, 10));\r\n    }\r\n    if (configOptions.locatePoint[0] && configOptions.locatePoint[1]) {\r\n        var point = new esri.geometry.Point([configOptions.locatePoint[0], configOptions.locatePoint[1]], new esri.SpatialReference({\r\n            wkid: map.spatialReference.wkid\r\n        }));\r\n        if (point) {\r\n            setMarker(point, configOptions.locateName);\r\n        }\r\n    }\r\n}\r\n\r\n// Configure\r\nfunction configureUserInterface() {\r\n    configureAppTitle();\r\n    createCustomSlider();\r\n    rightSideMenuButtons();\r\n    configureShareMenu();\r\n    configureSearchBox();\r\n    configureAboutText();\r\n    // short delay\r\n    setTimeout(function () {\r\n        extentReady();\r\n        setTimeout(function () {\r\n            updateSocialLayers();\r\n            dojo.connect(map, \"onExtentChange\", function (extent) {\r\n                // hide about panel if open\r\n                hideAboutMap();\r\n                // update current extent\r\n                configOptions.extent = [extent.xmin, extent.ymin, extent.xmax, extent.ymax];\r\n                // update sharing link\r\n                setSharing();\r\n                // hide auto complete\r\n                hideAC();\r\n                // reset refresh timer for social media\r\n                resetSocialRefreshTimer();\r\n            });\r\n        }, 800);\r\n        setSharing();\r\n    }, 800);\r\n}\r\n\r\n// add menus to dom\r\nfunction addSlideMenus() {\r\n    var html = '';\r\n    html += '<div id=\"dataMenuCon\">';\r\n    html += '<div data-menu=\"share\" id=\"shareControls\" class=\"slideMenu\"></div>';\r\n    html += '<div data-menu=\"autocomplete\" id=\"autoComplete\" class=\"slideMenu\"></div>';\r\n    html += '<div data-menu=\"places\" id=\"placesMenu\" class=\"slideMenu listMenu\"></div>';\r\n    html += '<div data-menu=\"basemap\" id=\"basemapMenu\" class=\"slideMenu\"></div>';\r\n    html += '<div data-menu=\"layers\" id=\"layersMenu\" class=\"slideMenu listMenu\"></div>';\r\n    html += '<div data-menu=\"social\" id=\"socialMenu\" class=\"slideMenu listMenu\"></div>';\r\n    html += '<div data-menu=\"legend\" id=\"legendMenu\" class=\"slideMenu\"></div>';\r\n    html += '</div>';\r\n    var node = dojo.query('#mapcon')[0];\r\n    if (node) {\r\n        dojo.place(html, node, \"last\");\r\n    }\r\n    dojo.query('#mapcon .slideMenu').style('display', 'none');\r\n}\r\n\r\n// webmap object returned. Create map data\r\nfunction webmapReturned(response) {\r\n    // webmap layers\r\n    var layers = response.itemInfo.itemData.operationalLayers;\r\n    // webmap\r\n    map = response.map;\r\n    // map connect functions\r\n    dojo.connect(window, \"onresize\", resizeMap);\r\n    // webmap item info\r\n    configOptions.itemInfo = response.itemInfo;\r\n    // webmap item data\r\n    configOptions.itemData = response.itemInfo.itemData;\r\n    // use places from agol bookmarks\r\n    configOptions.bookmarks = response.itemInfo.itemData.bookmarks;\r\n    // webmap presentation layer\r\n    configOptions.presentation = response.itemInfo.itemData.presentation;\r\n    // webmap operational layers\r\n    configOptions.itemLayers = response.itemInfo.itemData.operationalLayers;\r\n    // webmap basemap title by default\r\n    configOptions.basemapTitle = response.itemInfo.itemData.baseMap.title;\r\n\t// once map is loaded\r\n\tif (map.loaded) {\r\n\t\tmapIsLoaded();\r\n\t} else {\r\n\t\tdojo.connect(map, \"onLoad\", function () {\r\n\t\t\tmapIsLoaded();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction mapIsLoaded(){\r\n\t// create basemap gallery widget\r\n\tcreateBMGallery();\r\n\t// set up social media\r\n\tconfigureSocialMedia();\r\n\t// set up layer menu\r\n\tconfigureLayers();\r\n\t// set up places menu\r\n\tconfigurePlaces();\r\n\t// resize map\r\n\tresizeMap();\r\n\t// init UI\r\n\tconfigureUserInterface();\r\n\t// start extent\r\n\tsetExtentValues();\r\n\t// if local impact\r\n\tif(typeof initLocalImpact === 'function' && configOptions.localImpact && configOptions.localImpact.enabled) {\r\n\t\tinitLocalImpact();\r\n\t}\r\n}\r\n\r\n// Info window popup creation\r\nfunction configurePopup() {\r\n    // popup dijit configuration\r\n    configOptions.customPopup = new esri.dijit.Popup({\r\n        offsetX: 3,\r\n        fillSymbol: false,\r\n        highlight: false,\r\n        lineSymbol: false,\r\n        marginLeft: 10,\r\n        marginTop: 10,\r\n        markerSymbol: false,\r\n        offsetY: 3,\r\n        zoomFactor: 4\r\n    }, dojo.create(\"div\"));\r\n    // connects for popup\r\n    dojo.connect(configOptions.customPopup, \"maximize\", hideAllMenus);\r\n    dojo.connect(configOptions.customPopup, \"onSelectionChange\", overridePopupTitle);\r\n    dojo.connect(configOptions.customPopup, \"onHide\", clearPopupValues);\r\n    // popup theme\r\n    dojo.addClass(configOptions.customPopup.domNode, \"modernGrey\");\r\n}\r\n\r\n// Create the map object for the template\r\nfunction createWebMap() {\r\n    // configure popup\r\n    configurePopup();\r\n    // create map deferred with options\r\n    var mapDeferred = esri.arcgis.utils.createMap(configOptions.webmap, 'map', {\r\n        mapOptions: {\r\n            slider: false,\r\n            wrapAround180: true,\r\n            infoWindow: configOptions.customPopup,\r\n            isScrollWheelZoom: true\r\n        },\r\n        bingMapsKey: configOptions.bingMapsKey,\r\n        geometryServiceURL: configOptions.geometryserviceurl\r\n    });\r\n    // on successful response\r\n    mapDeferred.addCallback(function (response) {\r\n        webmapReturned(response);\r\n    });\r\n    // on error response\r\n    mapDeferred.addErrback(function (error) {\r\n        alertDialog(i18n.viewer.errors.createMap + \": \" + error.message);\r\n    });\r\n}\r\n\r\n// Initial function\r\nfunction init() {\r\n    // Overwrite from url values\r\n    setConfigOptions();\r\n    // add menus\r\n    addSlideMenus();\r\n    // Create Map\r\n    createWebMap();\r\n    // filtering\r\n    if(typeof createSMFBadWords === 'function') {\r\n         createSMFBadWords();\r\n    }\r\n    if(typeof createSMFOffensive === 'function') {\r\n        createSMFOffensive();\r\n    }\r\n}\r\n\r\n// On load of libraries\r\ndojo.addOnLoad(function () {\r\n    // set localization\r\n    i18n = dojo.i18n.getLocalization(\"esriTemplate\", \"template\");\r\n    setConfigOptions();\r\n    // dojo ready\r\n    setAppIdSettings(init);\r\n});"]],"start1":0,"start2":0,"length1":0,"length2":34172}]],"length":34172}
{"contributors":[],"silentsave":true,"ts":1358198133805,"patch":[[{"diffs":[[0,"t);\r\n});"],[1,"\r\n\r\n\r\n"]],"start1":34164,"start2":34164,"length1":8,"length2":14}]],"length":34178,"saved":false}
{"ts":1358198135228,"patch":[[{"diffs":[[0,";\r\n});\r\n\r\n\r\n"],[1,"//"]],"start1":34166,"start2":34166,"length1":12,"length2":14}]],"length":34180,"saved":false}
{"ts":1358198146276,"patch":[[{"diffs":[[0,"\n});\r\n\r\n\r\n//"],[1,"Iframe interg"]],"start1":34168,"start2":34168,"length1":12,"length2":25}]],"length":34193,"saved":false}
{"ts":1358198147487,"patch":[[{"diffs":[[0,"e interg"],[1,"r"]],"start1":34185,"start2":34185,"length1":8,"length2":9}]],"length":34194,"saved":false}
{"ts":1358198149536,"patch":[[{"diffs":[[0," intergr"],[1,"ation df"]],"start1":34186,"start2":34186,"length1":8,"length2":16}]],"length":34202,"saved":false}
{"ts":1358198151880,"patch":[[{"diffs":[[0,"ion "],[-1,"d"],[0,"f"],[1,"unction"]],"start1":34196,"start2":34196,"length1":6,"length2":12}]],"length":34208,"saved":false}
{"ts":1358198154188,"patch":[[{"diffs":[[0,"gration function"],[1,"\r\n"]],"start1":34192,"start2":34192,"length1":16,"length2":18}]],"length":34210,"saved":false}
{"ts":1358198156641,"patch":[[{"diffs":[[0,"ation function\r\n"],[1,"function"]],"start1":34194,"start2":34194,"length1":16,"length2":24}]],"length":34218,"saved":false}
{"ts":1358198159719,"patch":[[{"diffs":[[0,"ation function\r\nfunction"],[1," "]],"start1":34194,"start2":34194,"length1":24,"length2":25}]],"length":34219,"saved":false}
{"ts":1358198162961,"patch":[[{"diffs":[[0,"rgration function\r\nfunction "],[1,"show"]],"start1":34191,"start2":34191,"length1":28,"length2":32}]],"length":34223,"saved":false}
{"ts":1358198168519,"patch":[[{"diffs":[[0,"ction\r\nfunction show"],[1,"Lo"]],"start1":34203,"start2":34203,"length1":20,"length2":22}]],"length":34225,"saved":false}
{"ts":1358198170481,"patch":[[{"diffs":[[0,"ion show"],[-1,"Lo"]],"start1":34215,"start2":34215,"length1":10,"length2":8}]],"length":34223,"saved":false}
{"ts":1358198170944,"patch":[[{"diffs":[[0,"ction\r\nfunction show"],[1,"P"]],"start1":34203,"start2":34203,"length1":20,"length2":21}]],"length":34224,"saved":false}
{"ts":1358198172460,"patch":[[{"diffs":[[0,"nction showP"],[1,"lace"]],"start1":34212,"start2":34212,"length1":12,"length2":16}]],"length":34228,"saved":false}
{"ts":1358198174743,"patch":[[{"diffs":[[0,"nction showPlace"],[1,"Points"]],"start1":34212,"start2":34212,"length1":16,"length2":22}]],"length":34234,"saved":false}
{"ts":1358198175693,"patch":[[{"diffs":[[0,"cePoints"],[1,"()"]],"start1":34226,"start2":34226,"length1":8,"length2":10}]],"length":34236,"saved":false}
{"ts":1358198178023,"patch":[[{"diffs":[[0,"Points()"],[1,"{\r\n\r\n}"]],"start1":34228,"start2":34228,"length1":8,"length2":14}]],"length":34242,"saved":false}
{"ts":1358198178957,"patch":[[{"diffs":[[0,"nts(){\r\n"],[-1,"\r\n"],[0,"}"]],"start1":34231,"start2":34231,"length1":11,"length2":9}]],"length":34240,"saved":false}
{"ts":1358198181507,"patch":[[{"diffs":[[0,"ts(){\r\n}"],[1,"\r\n\r\nfunciton"]],"start1":34232,"start2":34232,"length1":8,"length2":20}]],"length":34252,"saved":false}
{"ts":1358198182133,"patch":[[{"diffs":[[0,"\nfuncito"],[-1,"n"]],"start1":34243,"start2":34243,"length1":9,"length2":8}]],"length":34251,"saved":false}
{"ts":1358198183577,"patch":[[{"diffs":[[0,"\nfun"],[-1,"cito"],[1,"t"]],"start1":34243,"start2":34243,"length1":8,"length2":5}]],"length":34248,"saved":false}
{"ts":1358198188111,"patch":[[{"diffs":[[0,"}\r\n\r\nfun"],[-1,"t"],[1,"ction "]],"start1":34239,"start2":34239,"length1":9,"length2":14}]],"length":34253,"saved":false}
{"ts":1358198188670,"patch":[[{"diffs":[[0,"oints(){\r\n}\r\n\r\nfunction "],[1,"sh"]],"start1":34229,"start2":34229,"length1":24,"length2":26}]],"length":34255,"saved":false}
{"ts":1358198189773,"patch":[[{"diffs":[[0,"){\r\n}\r\n\r\nfunction sh"],[1,"owS"]],"start1":34235,"start2":34235,"length1":20,"length2":23}]],"length":34258,"saved":false}
{"ts":1358198192326,"patch":[[{"diffs":[[0,"nction showS"],[1,"ocial"]],"start1":34246,"start2":34246,"length1":12,"length2":17}]],"length":34263,"saved":false}
{"ts":1358198193987,"patch":[[{"diffs":[[0,"ction showSocial"],[1,"Mei"]],"start1":34247,"start2":34247,"length1":16,"length2":19}]],"length":34266,"saved":false}
{"ts":1358198195363,"patch":[[{"diffs":[[0,"SocialMe"],[-1,"i"],[1,"d"]],"start1":34257,"start2":34257,"length1":9,"length2":9}]],"length":34266,"saved":false}
{"ts":1358198196712,"patch":[[{"diffs":[[0,"on showSocialMed"],[1,"iaPo"]],"start1":34250,"start2":34250,"length1":16,"length2":20}]],"length":34270,"saved":false}
{"ts":1358198198158,"patch":[[{"diffs":[[0,"lMediaPo"],[1,"ints()"]],"start1":34262,"start2":34262,"length1":8,"length2":14}]],"length":34276,"saved":false}
{"ts":1358198200329,"patch":[[{"diffs":[[0,"ialMediaPoints()"],[1,"{\r\n  \r\n}"]],"start1":34260,"start2":34260,"length1":16,"length2":24}]],"length":34284,"saved":false}
{"ts":1358198200685,"patch":[[{"diffs":[[0,"nts(){\r\n"],[-1,"  "],[0,"\r\n}"]],"start1":34271,"start2":34271,"length1":13,"length2":11}]],"length":34282,"saved":false}
{"ts":1358198270631,"patch":[[{"diffs":[[0,"nts(){\r\n"],[1,"  var hi\r\n"],[0,"}\r\n\r\nfun"]],"start1":34231,"start2":34231,"length1":16,"length2":26}]],"length":34292,"saved":false}
{"ts":1358198270957,"patch":[[{"diffs":[[0,"  var hi"],[1,"de"],[0,"\r\n}\r\n\r\nf"]],"start1":34239,"start2":34239,"length1":16,"length2":18}]],"length":34294,"saved":false}
{"ts":1358198272821,"patch":[[{"diffs":[[0,"var hide"],[1," = "],[0,"\r\n}\r\n\r\nf"]],"start1":34241,"start2":34241,"length1":16,"length2":19}]],"length":34297,"saved":false}
{"ts":1358198273796,"patch":[[{"diffs":[[0," hide = "],[1,"[]"],[0,"\r\n}\r\n\r\nf"]],"start1":34244,"start2":34244,"length1":16,"length2":18}]],"length":34299,"saved":false}
{"ts":1358198275313,"patch":[[{"diffs":[[0,"hide = ["],[1,"\"\""],[0,"]\r\n}\r\n\r\n"]],"start1":34245,"start2":34245,"length1":16,"length2":18}]],"length":34301,"saved":false}
{"ts":1358198283314,"patch":[[{"diffs":[[0,"ide = [\""],[1,"flickr"],[0,"\"]\r\n}\r\n\r"]],"start1":34246,"start2":34246,"length1":16,"length2":22}]],"length":34307,"saved":false}
{"ts":1358198285372,"patch":[[{"diffs":[[0,"\"flickr\""],[1,","],[0,"]\r\n}\r\n\r\n"]],"start1":34253,"start2":34253,"length1":16,"length2":17}]],"length":34308,"saved":false}
{"ts":1358198286480,"patch":[[{"diffs":[[0,"flickr\","],[1,"\"\""],[0,"]\r\n}\r\n\r\n"]],"start1":34254,"start2":34254,"length1":16,"length2":18}]],"length":34310,"saved":false}
{"ts":1358198289384,"patch":[[{"diffs":[[0,"lickr\",\""],[1,"youtube"],[0,"\"]\r\n}\r\n\r"]],"start1":34255,"start2":34255,"length1":16,"length2":23}]],"length":34317,"saved":false}
{"ts":1358198292483,"patch":[[{"diffs":[[0,"outube\"]"],[1,";\r\n  "],[0,"\r\n}\r\n\r\nf"]],"start1":34264,"start2":34264,"length1":16,"length2":21}]],"length":34322,"saved":false}
{"ts":1358198293606,"patch":[[{"diffs":[[0,"e\"];\r\n  "],[1,"var"],[0,"\r\n}\r\n\r\nf"]],"start1":34269,"start2":34269,"length1":16,"length2":19}]],"length":34325,"saved":false}
{"ts":1358198296569,"patch":[[{"diffs":[[0,";\r\n  var"],[1," show = []"],[0,"\r\n}\r\n\r\nf"]],"start1":34272,"start2":34272,"length1":16,"length2":26}]],"length":34335,"saved":false}
{"ts":1358198309966,"patch":[[{"diffs":[[0,"show = ["],[1,"\"csv_9231_0\", \"csv_5785_0\", \"csv_6734_0\", \"csv_5969_0\", \"csv_4224_0\", \"csv_3458_0\", \"csv_7156_0\", \"csv_1027_0\""],[0,"]\r\n}\r\n\r\n"]],"start1":34281,"start2":34281,"length1":16,"length2":126}]],"length":34445,"saved":false}
{"ts":1358198312487,"patch":[[{"diffs":[[0,"1027_0\"]"],[1,";"],[0,"\r\n}\r\n\r\nf"]],"start1":34392,"start2":34392,"length1":16,"length2":17}]],"length":34446,"saved":false}
{"ts":1358198322615,"patch":[[{"diffs":[[0,"nts(){\r\n"],[1,"  var hide = [\"flickr\",\"youtube\"];\r\n  var show = [\"csv_9231_0\", \"csv_5785_0\", \"csv_6734_0\", \"csv_5969_0\", \"csv_4224_0\", \"csv_3458_0\", \"csv_7156_0\", \"csv_1027_0\"];"],[0,"\r\n}"]],"start1":34435,"start2":34435,"length1":11,"length2":173}]],"length":34608,"saved":false}
{"ts":1358198387846,"patch":[[{"diffs":[[0,"7_0\"];\r\n"],[1,"  \r\n  dojo.forEach(hide,function(lyr){\r\n    map.getLayer()    \r\n  });\r\n"],[0,"}\r\n\r\nfun"]],"start1":34395,"start2":34395,"length1":16,"length2":87},{"diffs":[[0,"de ="],[-1," [\"flickr\",\"youtube\"];\r\n  var show ="],[0," [\"c"]],"start1":34522,"start2":34522,"length1":44,"length2":8},{"diffs":[[0,"7_0\"];\r\n"],[1,"  var show = [\"flickr\",\"youtube\"];\r\n"],[0,"}"]],"start1":34634,"start2":34634,"length1":9,"length2":45}]],"length":34679,"saved":false}
{"ts":1358198388172,"patch":[[{"diffs":[[0,"7_0\"];\r\n"],[-1,"  "],[0,"\r\n  dojo"]],"start1":34395,"start2":34395,"length1":18,"length2":16},{"diffs":[[0,"tLayer()"],[-1,"    "],[0,"\r\n  });\r"]],"start1":34451,"start2":34451,"length1":20,"length2":16}]],"length":34673,"saved":false}
{"ts":1358198390533,"patch":[[{"diffs":[[0,"etLayer("],[1,"lyr"],[0,")\r\n  });"]],"start1":34450,"start2":34450,"length1":16,"length2":19}]],"length":34676,"saved":false}
{"ts":1358198392768,"patch":[[{"diffs":[[0,"yer(lyr)"],[1,".hide"],[0,"\r\n  });\r"]],"start1":34454,"start2":34454,"length1":16,"length2":21}]],"length":34681,"saved":false}
{"ts":1358198394556,"patch":[[{"diffs":[[0,"yr).hide"],[1,"();"],[0,"\r\n  });\r"]],"start1":34459,"start2":34459,"length1":16,"length2":19}]],"length":34684,"saved":false}
{"ts":1358198405755,"patch":[[{"diffs":[[0,"0\"];\r\n\r\n"],[1,"  dojo.forEach(hide,function(lyr){\r\n    map.getLayer(lyr).hide();\r\n  });\r\n  \r\n"],[0,"  dojo.f"]],"start1":34397,"start2":34397,"length1":16,"length2":94}]],"length":34762,"saved":false}
{"ts":1358198412153,"patch":[[{"diffs":[[0,"ach("],[-1,"hide,function(lyr){\r\n    map.getLayer(lyr).hide();\r\n  }"],[1,"sho"],[0,");\r\n"]],"start1":34494,"start2":34494,"length1":63,"length2":11}]],"length":34710,"saved":false}
{"ts":1358198413512,"patch":[[{"diffs":[[0,"forEach("],[-1,"sho"],[1,"hide,function(lyr){\r\n    map.getLayer(lyr).hide();\r\n  }"],[0,");\r\n}\r\n\r"]],"start1":34490,"start2":34490,"length1":19,"length2":71}]],"length":34762,"saved":false}
{"ts":1358198416177,"patch":[[{"diffs":[[0,"\n  dojo.forEach("],[-1,"hide"],[1,"show"],[0,",function(lyr){\r"]],"start1":34482,"start2":34482,"length1":36,"length2":36}]],"length":34762,"saved":false}
{"ts":1358198419224,"patch":[[{"diffs":[[0,"p.getLayer(lyr)."],[-1,"hide"],[1,"show"],[0,"();\r\n  });\r\n}\r\n\r"]],"start1":34525,"start2":34525,"length1":36,"length2":36}]],"length":34762,"saved":false}
{"ts":1358198427488,"patch":[[{"diffs":[[0,"ube\"];\r\n"],[1,"  \r\n  dojo.forEach(hide,function(lyr){\r\n    map.getLayer(lyr).hide();\r\n  });\r\n  \r\n  dojo.forEach(show,function(lyr){\r\n    map.getLayer(lyr).show();\r\n  });\r\n"],[0,"}"]],"start1":34753,"start2":34753,"length1":9,"length2":165}]],"length":34918,"saved":false}
{"ts":1358198429458,"patch":[[{"diffs":[[0,"hide();\r\n  });\r\n"],[-1,"  "],[0,"\r\n  dojo.forEach"]],"start1":34463,"start2":34463,"length1":34,"length2":32},{"diffs":[[0,"ube\"];\r\n"],[-1,"  "],[0,"\r\n  dojo"]],"start1":34751,"start2":34751,"length1":18,"length2":16},{"diffs":[[0,"\n  });\r\n"],[-1,"  "],[0,"\r\n  dojo"]],"start1":34827,"start2":34827,"length1":18,"length2":16}]],"length":34912,"saved":false}
{"ts":1358200360270,"patch":[[{"diffs":[[0,"ded();\r\n"],[1,"    show\r\n"],[0,"\t} else "]],"start1":31379,"start2":31379,"length1":16,"length2":26}]],"length":34922,"saved":false}
{"ts":1358200361925,"patch":[[{"diffs":[[0,"    show"],[1,"PlacePoints()"],[0,"\r\n\t} els"]],"start1":31387,"start2":31387,"length1":16,"length2":29}]],"length":34935,"saved":false}
{"ts":1358200363491,"patch":[[{"diffs":[[0,"Points()"],[1,";"],[0,"\r\n\t} els"]],"start1":31400,"start2":31400,"length1":16,"length2":17}]],"length":34936,"saved":false}
{"ts":1358200367245,"patch":[[{"diffs":[[0,"ded();\r\n"],[1,"      show\r\n"],[0,"\t\t});\r\n\t"]],"start1":31478,"start2":31478,"length1":16,"length2":28}]],"length":34948,"saved":false}
{"ts":1358200368097,"patch":[[{"diffs":[[0,"    show"],[1,"PlacePoints()"],[0,"\r\n\t\t});\r"]],"start1":31488,"start2":31488,"length1":16,"length2":29}]],"length":34961,"saved":false}
{"ts":1358200368779,"patch":[[{"diffs":[[0,"Points()"],[1,";"],[0,"\r\n\t\t});\r"]],"start1":31501,"start2":31501,"length1":16,"length2":17}]],"length":34962,"saved":false}
{"ts":1358200397636,"patch":[[{"diffs":[[0,");\r\n"],[-1,"      showPlacePoints();\r\n"],[0,"\t\t})"]],"start1":31482,"start2":31482,"length1":34,"length2":8}]],"length":34936,"saved":false}
{"ts":1358200400399,"patch":[[{"diffs":[[0,");\r\n"],[-1,"    showPlacePoints();\r\n"],[0,"\t} e"]],"start1":31383,"start2":31383,"length1":32,"length2":8}]],"length":34912,"saved":false}
{"ts":1358200403598,"patch":[[{"diffs":[[0,"\n\t\t});\r\n\t}\r\n"],[1,"  \r\n  map\r\n"],[0,"}\r\n\r\nfunctio"]],"start1":31461,"start2":31461,"length1":24,"length2":35}]],"length":34923,"saved":false}
{"ts":1358200406782,"patch":[[{"diffs":[[0,"\t}\r\n  \r\n"],[-1,"  map"],[0,"\r\n}\r\n\r\nf"]],"start1":31469,"start2":31469,"length1":21,"length2":16}]],"length":34918,"saved":false}
{"ts":1358200407116,"patch":[[{"diffs":[[0,");\r\n\t}\r\n"],[-1,"  "],[0,"\r\n\r\n}\r\n\r"]],"start1":31465,"start2":31465,"length1":18,"length2":16}]],"length":34916,"saved":false}
{"ts":1358200408224,"patch":[[{"diffs":[[0,"\r\n\t}\r\n\r\n"],[1,"  "],[0,"\r\n}\r\n\r\nf"]],"start1":31467,"start2":31467,"length1":16,"length2":18}]],"length":34918,"saved":false}
{"ts":1358200413714,"patch":[[{"diffs":[[0,"\t}\r\n\r\n  "],[1,"dojo.c"],[0,"\r\n}\r\n\r\nf"]],"start1":31469,"start2":31469,"length1":16,"length2":22}]],"length":34924,"saved":false}
{"ts":1358200414028,"patch":[[{"diffs":[[0,"  dojo.c"],[1,"o"],[0,"\r\n}\r\n\r\nf"]],"start1":31475,"start2":31475,"length1":16,"length2":17}]],"length":34925,"saved":false}
{"ts":1358200415655,"patch":[[{"diffs":[[0," dojo.co"],[1,"nnect()"],[0,"\r\n}\r\n\r\nf"]],"start1":31476,"start2":31476,"length1":16,"length2":23}]],"length":34932,"saved":false}
{"ts":1358200419963,"patch":[[{"diffs":[[0,"connect("],[1,"map"],[0,")\r\n}\r\n\r\n"]],"start1":31482,"start2":31482,"length1":16,"length2":19}]],"length":34935,"saved":false}
{"ts":1358200420313,"patch":[[{"diffs":[[0,"nect(map"],[1,","],[0,")\r\n}\r\n\r\n"]],"start1":31485,"start2":31485,"length1":16,"length2":17}]],"length":34936,"saved":false}
{"ts":1358200423367,"patch":[[{"diffs":[[0,"ect(map,"],[1,"onup"],[0,")\r\n}\r\n\r\n"]],"start1":31486,"start2":31486,"length1":16,"length2":20}]],"length":34940,"saved":false}
{"ts":1358200424080,"patch":[[{"diffs":[[0,"(map,onu"],[-1,"p"],[0,")\r\n}\r\n\r\n"]],"start1":31489,"start2":31489,"length1":17,"length2":16}]],"length":34939,"saved":false}
{"ts":1358200426790,"patch":[[{"diffs":[[0,"map,"],[1,"\""],[0,"on"],[-1,"u"],[1,"\""],[0,")\r\n}"]],"start1":31490,"start2":31490,"length1":11,"length2":12}]],"length":34940,"saved":false}
{"ts":1358200429176,"patch":[[{"diffs":[[0,"(map,\"on"],[1,"Update"],[0,"\")\r\n}\r\n\r"]],"start1":31489,"start2":31489,"length1":16,"length2":22}]],"length":34946,"saved":false}
{"ts":1358200430507,"patch":[[{"diffs":[[0,"onUpdate"],[1,"End"],[0,"\")\r\n}\r\n\r"]],"start1":31495,"start2":31495,"length1":16,"length2":19}]],"length":34949,"saved":false}
{"ts":1358200434884,"patch":[[{"diffs":[[0,"dateEnd\""],[1,",func"],[0,")\r\n}\r\n\r\n"]],"start1":31499,"start2":31499,"length1":16,"length2":21}]],"length":34954,"saved":false}
{"ts":1358200436027,"patch":[[{"diffs":[[0,"nd\",func"],[1,"tion"],[0,")\r\n}\r\n\r\n"]],"start1":31504,"start2":31504,"length1":16,"length2":20}]],"length":34958,"saved":false}
{"ts":1358200436882,"patch":[[{"diffs":[[0,"function"],[1,"()"],[0,")\r\n}\r\n\r\n"]],"start1":31508,"start2":31508,"length1":16,"length2":18}]],"length":34960,"saved":false}
{"ts":1358200438253,"patch":[[{"diffs":[[0,"nction()"],[1,"{\r\n    \r\n  }"],[0,")\r\n}\r\n\r\n"]],"start1":31510,"start2":31510,"length1":16,"length2":28}]],"length":34972,"saved":false}
{"ts":1358200441745,"patch":[[{"diffs":[[0,"){\r\n    "],[1,"if"],[0,"\r\n  })\r\n"]],"start1":31517,"start2":31517,"length1":16,"length2":18}]],"length":34974,"saved":false}
{"ts":1358200447017,"patch":[[{"diffs":[[0,"\r\n    if"],[1," ()"],[0,"\r\n  })\r\n"]],"start1":31519,"start2":31519,"length1":16,"length2":19}]],"length":34977,"saved":false}
{"ts":1358200453961,"patch":[[{"diffs":[[0,"    if ("],[1,"!m"],[0,")\r\n  })\r"]],"start1":31521,"start2":31521,"length1":16,"length2":18}]],"length":34979,"saved":false}
{"ts":1358200454832,"patch":[[{"diffs":[[0,"  if (!m"],[1,"ap"],[0,")\r\n  })\r"]],"start1":31523,"start2":31523,"length1":16,"length2":18}]],"length":34981,"saved":false}
{"ts":1358200459528,"patch":[[{"diffs":[[0,"if (!map"],[1,".first"],[0,")\r\n  })\r"]],"start1":31525,"start2":31525,"length1":16,"length2":22}]],"length":34987,"saved":false}
{"ts":1358200461894,"patch":[[{"diffs":[[0,"ap.first"],[1,"Update"],[0,")\r\n  })\r"]],"start1":31531,"start2":31531,"length1":16,"length2":22}]],"length":34993,"saved":false}
{"ts":1358200466016,"patch":[[{"diffs":[[0,"tUpdate)"],[1,"{\r\n      map\r\n    }"],[0,"\r\n  })\r\n"]],"start1":31538,"start2":31538,"length1":16,"length2":35}]],"length":35012,"saved":false}
{"ts":1358200483439,"patch":[[{"diffs":[[0,"     map"],[1,".fir"],[0,"\r\n    }\r"]],"start1":31550,"start2":31550,"length1":16,"length2":20}]],"length":35016,"saved":false}
{"ts":1358200485876,"patch":[[{"diffs":[[0," map.fir"],[1,"stUpdate = atr"],[0,"\r\n    }\r"]],"start1":31554,"start2":31554,"length1":16,"length2":30}]],"length":35030,"saved":false}
{"ts":1358200486200,"patch":[[{"diffs":[[0,"ate = at"],[-1,"r"],[0,"\r\n    }\r"]],"start1":31567,"start2":31567,"length1":17,"length2":16}]],"length":35029,"saved":false}
{"ts":1358200487419,"patch":[[{"diffs":[[0,"pdate = "],[-1,"a"],[0,"t"],[1,"rue"],[0,"\r\n    }\r"]],"start1":31565,"start2":31565,"length1":18,"length2":20}]],"length":35031,"saved":false}
{"ts":1358200488177,"patch":[[{"diffs":[[0,"pdate = true"],[1,";"],[0,"\r\n    }\r\n  }"]],"start1":31565,"start2":31565,"length1":24,"length2":25}]],"length":35032,"saved":false}
{"ts":1358200489250,"patch":[[{"diffs":[[0,"te = true;\r\n"],[1,"      \r\n    showPlacePoints();\r\n"],[0,"    }\r\n  })\r"]],"start1":31568,"start2":31568,"length1":24,"length2":56}]],"length":35064,"saved":false}
{"ts":1358200492298,"patch":[[{"diffs":[[0,"  \r\n"],[-1,"    showPlacePoints();\r\n"],[0,"    "]],"start1":31584,"start2":31584,"length1":32,"length2":8}]],"length":35040,"saved":false}
{"ts":1358200493309,"patch":[[{"diffs":[[0,"e;\r\n"],[-1,"      \r\n"],[0,"    "]],"start1":31576,"start2":31576,"length1":16,"length2":8}]],"length":35032,"saved":false}
{"ts":1358200494367,"patch":[[{"diffs":[[0,"e = true"],[-1,";"],[0,"\r\n    }\r"]],"start1":31569,"start2":31569,"length1":17,"length2":16}]],"length":35031,"saved":false}
{"ts":1358200495446,"patch":[[{"diffs":[[0,"pdate = true"],[1,";\r\n    showPlacePoints();"],[0,"\r\n    }\r\n  }"]],"start1":31565,"start2":31565,"length1":24,"length2":49}]],"length":35056,"saved":false}
{"ts":1358200499091,"patch":[[{"diffs":[[0," true;\r\n    "],[1,"  "],[0,"showPlacePoi"]],"start1":31572,"start2":31572,"length1":24,"length2":26}]],"length":35058,"saved":false}
{"ts":1358200505516,"patch":[[{"diffs":[[0," }\r\n  })"],[1,";"],[0,"\r\n}\r\n\r\nf"]],"start1":31609,"start2":31609,"length1":16,"length2":17}]],"length":35059,"saved":false}
